process.env.HMR_PORT=0;process.env.HMR_HOSTNAME="";require=function(r,e,n){function t(n,o){function i(r){return t(i.resolve(r))}function f(e){return r[n][1][e]||e}if(!e[n]){if(!r[n]){var c="function"==typeof require&&require;if(!o&&c)return c(n,!0);if(u)return u(n,!0);var l=new Error("Cannot find module '"+n+"'");throw l.code="MODULE_NOT_FOUND",l}i.resolve=f;var s=e[n]=new t.Module(n);r[n][0].call(s.exports,i,s,s.exports)}return e[n].exports}function o(r){this.id=r,this.bundle=t,this.exports={}}var u="function"==typeof require&&require;t.isParcelRequire=!0,t.Module=o,t.modules=r,t.cache=e,t.parent=u;for(var i=0;i<n.length;i++)t(n[i]);return t}({12:[function(require,module,exports) {
"use strict";if(Object.defineProperty(exports,"__esModule",{value:!0}),void 0===_)var _={DOM_VK_CANCEL:3,DOM_VK_HELP:6,DOM_VK_BACK_SPACE:8,DOM_VK_TAB:9,DOM_VK_CLEAR:12,DOM_VK_RETURN:13,DOM_VK_ENTER:14,DOM_VK_SHIFT:16,DOM_VK_CONTROL:17,DOM_VK_ALT:18,DOM_VK_PAUSE:19,DOM_VK_CAPS_LOCK:20,DOM_VK_ESCAPE:27,DOM_VK_SPACE:32,DOM_VK_PAGE_UP:33,DOM_VK_PAGE_DOWN:34,DOM_VK_END:35,DOM_VK_HOME:36,DOM_VK_LEFT:37,DOM_VK_UP:38,DOM_VK_RIGHT:39,DOM_VK_DOWN:40,DOM_VK_PRINTSCREEN:44,DOM_VK_INSERT:45,DOM_VK_DELETE:46,DOM_VK_0:48,DOM_VK_1:49,DOM_VK_2:50,DOM_VK_3:51,DOM_VK_4:52,DOM_VK_5:53,DOM_VK_6:54,DOM_VK_7:55,DOM_VK_8:56,DOM_VK_9:57,DOM_VK_SEMICOLON:59,DOM_VK_EQUALS:61,DOM_VK_A:65,DOM_VK_B:66,DOM_VK_C:67,DOM_VK_D:68,DOM_VK_E:69,DOM_VK_F:70,DOM_VK_G:71,DOM_VK_H:72,DOM_VK_I:73,DOM_VK_J:74,DOM_VK_K:75,DOM_VK_L:76,DOM_VK_M:77,DOM_VK_N:78,DOM_VK_O:79,DOM_VK_P:80,DOM_VK_Q:81,DOM_VK_R:82,DOM_VK_S:83,DOM_VK_T:84,DOM_VK_U:85,DOM_VK_V:86,DOM_VK_W:87,DOM_VK_X:88,DOM_VK_Y:89,DOM_VK_Z:90,DOM_VK_CONTEXT_MENU:93,DOM_VK_NUMPAD0:96,DOM_VK_NUMPAD1:97,DOM_VK_NUMPAD2:98,DOM_VK_NUMPAD3:99,DOM_VK_NUMPAD4:100,DOM_VK_NUMPAD5:101,DOM_VK_NUMPAD6:102,DOM_VK_NUMPAD7:103,DOM_VK_NUMPAD8:104,DOM_VK_NUMPAD9:105,DOM_VK_MULTIPLY:106,DOM_VK_ADD:107,DOM_VK_SEPARATOR:108,DOM_VK_SUBTRACT:109,DOM_VK_DECIMAL:110,DOM_VK_DIVIDE:111,DOM_VK_F1:112,DOM_VK_F2:113,DOM_VK_F3:114,DOM_VK_F4:115,DOM_VK_F5:116,DOM_VK_F6:117,DOM_VK_F7:118,DOM_VK_F8:119,DOM_VK_F9:120,DOM_VK_F10:121,DOM_VK_F11:122,DOM_VK_F12:123,DOM_VK_F13:124,DOM_VK_F14:125,DOM_VK_F15:126,DOM_VK_F16:127,DOM_VK_F17:128,DOM_VK_F18:129,DOM_VK_F19:130,DOM_VK_F20:131,DOM_VK_F21:132,DOM_VK_F22:133,DOM_VK_F23:134,DOM_VK_F24:135,DOM_VK_NUM_LOCK:144,DOM_VK_SCROLL_LOCK:145,DOM_VK_COMMA:188,DOM_VK_PERIOD:190,DOM_VK_SLASH:191,DOM_VK_BACK_QUOTE:192,DOM_VK_OPEN_BRACKET:219,DOM_VK_BACK_SLASH:220,DOM_VK_CLOSE_BRACKET:221,DOM_VK_QUOTE:222,DOM_VK_META:224};exports.KeyEvent=_;
},{}],5:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=!0;class t{constructor(e=!1){this.synth=window.speechSynthesis,this.webTTS=e}speak(e){if(!this.webTTS){document.getElementById("speech").innerHTML="";var t=document.createElement("p");return t.appendChild(document.createTextNode(e)),void document.getElementById("speech").appendChild(t)}var s=new SpeechSynthesisUtterance(e);this.synth.stop(),this.synth.speak(s)}setWebTTS(e){this.webTTS=e}}if(void 0===s)var s=new t;exports.TTS=t,exports.speech=s;
},{}],10:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.so=void 0;var s,e=require("howler"),t=require("./tts"),o=!0;class n{constructor(s,t=0,o=0){var n=this;this.fileName=s,this.sound=new e.Howl({src:s,onload:function(){n.doneLoading()}}),this.timeout=setTimeout(function(){n.checkProgress()},2e3),this.loaded=!1,this.callback=t,this.timeToLoad=performance.now(),this.tag=o}checkProgress(){if("loaded"==this.sound.state())this.doneLoading();else{var s=this;this.timeout=setTimeout(function(){s.checkProgress()},500)}}doneLoading(){clearTimeout(this.timeout),this.loaded=!0,0!=this.callback&&this.callback()}play(){this.sound.play()}stop(){this.sound.stop()}pause(){this.sound.pause()}destroy(){t.speech.speak("yay"),this.sound.unload()}unload(){this.sound.unload()}get volume(){return this.sound.volume()}set volume(s){return this.sound.volume(s)}set loop(s){return this.sound.loop(s)}get loop(){return this.sound.loop()}get playing(){return this.sound.playing()}get playbackRate(){return this.sound.rate()}set playbackRate(s){return this.sound.rate(s)}get currentTime(){return this.sound.seek()}get duration(){return this.sound.duration}get position(){return this.sound.seek()}set currentTime(s){return this.sound.seek(s)}seek(s){return this.sound.seek(s)}}class i{constructor(){this.sounds=new Array,this.oneShots=new Array,this.debug=!1,this.loadingQueue=!1,this.queueCallback=0,this.loadedSounds=0,this.loadingSounds=0,this.loadedCallback=0,this.queue=new Array,this.queueLength=0,this.statusCallback=null,this.extension=".ogg",1==o?this.directory="./sounds/":(this.directory="../soundsopus/",this.extension=".opus"),this.oneShotSound=null}setStatusCallback(s){this.statusCallback=s}findSound(s){for(var e in this.sounds)if(this.sounds[e].fileName==s)return this.sounds[e];return-1}findSoundIndex(s){for(var e in this.sounds)if(this.sounds[e].fileName==s)return e;return-1}resetQueuedInstance(){for(var s=0;s<this.sounds.length;s++)void 0!==this.sounds[s]&&1==this.sounds[s].tag&&(this.sounds[s].sound.unload(),this.sounds.splice(s,1));this.loadingQueue=!1,this.queueCallback=0,this.loadedSounds=0,this.loadingSounds=0,this.loadedCallback=0,this.queue=new Array,this.queueLength=0,this.statusCallback=null}create(s){s=this.directory+s+this.extension;var e,t=this;return e=new n(s,function(){t.doneLoading()}),this.sounds.push(e),e}enqueue(s){s=this.directory+s+this.extension,this.queue.push(s),this.queueLength=this.queue.length}loadQueue(){this.handleQueue(),this.loadingQueue=!0}setQueueCallback(s){this.queueCallback=s}resetQueue(){this.queue=new Array,this.loadingQueue=!1}handleQueue(){if(this.queue.length>0){var s=this;if(void 0!==this.statusCallback&&null!=this.statusCallback&&this.statusCallback(1-this.queue.length/this.queueLength),-1!=this.findSound(this.queue[0]))return this.queue.splice(0,1),void this.handleQueue();this.sounds.push(new n(this.queue[0],function(){s.handleQueue()},1)),this.queue.splice(0,1)}else this.loadingQueue=!1,console.log("finished with queue."),void 0!==this.queueCallback&&0!=this.queueCallback&&this.queueCallback()}setCallback(s){this.loadedCallback=s}doneLoading(){1==this.isLoading()&&void 0!==this.loadedCallback&&0!=this.loadedCallback&&null!=this.loadedCallback&&this.loadedCallback()}isLoading(){this.loadedSounds=0,this.loadingSounds=0;new Array;for(var s=0;s<this.sounds.length;s++)void 0!==this.sounds[s]&&(0==this.sounds[s].loaded?this.loadingSounds++:this.loadedSounds++);return this.loadedSounds/this.sounds.length}playOnce(s){this.oneShotSound=u.create(s),this.oneShots.push(this.oneShotSound),this.oneShotSound.play();var e=new Array,o=this;this.oneShotSound.on("ended",function(){for(var s=0;s<o.oneShots.length;s++)0==o.oneShots[s].playing&&(o.oneShots[s].unload(),e.push(s));for(s=0;s<e.length;s++)0==o.oneShotSounds[s].playing&&(o.oneShotSounds.splice(e[s],1),t.speech.speak("destroyed."+e[s]))})}destroy(s,e=0){for(var t=!1,o=this.directory+s+this.extension;!t;){var n=this.findSoundIndex(o);console.log("found "+n),-1==n?t=!0:(this.sounds[n].sound.unload(),console.log("state after destroy"+this.sounds[n].sound.state()),this.sounds.splice(n,1),console.log("destroyed "+this.sounds.length))}0!=e&&e()}kill(s=0){for(;this.sounds.length>0;)this.sounds.splice(0,1);e.Howler.unload(),0!=s&&s()}}let u=new i;exports.so=u;
},{"./tts":5}],6:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.speech=exports.ScrollingText=void 0;var e=require("jquery"),t=r(e),s=require("./keycodes"),n=require("./soundObject"),i=require("./tts");function r(e){return e&&e.__esModule?e:{default:e}}if(void 0===a)var a=new i.TTS;if(void 0==d)var d=0;class h{constructor(e,t="\n",s=0){this.text=e,this.delimiter=t,this.splitText=this.text.split(t),this.currentLine=0,this.sndOpen=n.so.create("UI/textOpen"),this.sndContinue=n.so.create("UI/textScroll"),this.sndClose=n.so.create("UI/textClose"),this.callback=s;document.getElementById("touchArea");this.init()}init(){d=this,document.addEventListener("keydown",this.handleKeys),this.sndOpen.play(),this.currentLine=0,this.readCurrentLine()}handleKeys(e){switch(e.which){case s.KeyEvent.DOM_VK_UP:case s.KeyEvent.DOM_VK_DOWN:case s.KeyEvent.DOM_VK_LEFT:case s.KeyEvent.DOM_VK_RIGHT:d.readCurrentLine();break;case s.KeyEvent.DOM_VK_RETURN:d.advance()}}handleTap(e){0==e&&this.readCurrentLine(),1==e&&this.advance()}readCurrentLine(){a.speak(this.splitText[this.currentLine])}advance(){this.currentLine<this.splitText.length-1?(this.currentLine++,this.sndContinue.play(),this.readCurrentLine()):(this.sndClose.play(),this.sndClose.unload(),this.sndOpen.unload(),this.sndContinue.unload(),document.removeEventListener("keydown",this.handleKeys),0!=this.callback&&this.callback())}}exports.ScrollingText=h,exports.speech=a;
},{"./keycodes":12,"./soundObject":10,"./tts":5}],4:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class e{constructor(){this.strings={},this.strings[1]={mStart:"Start Game",mLearn:"Learn the pack",tamperWarning:"This pack has been tampered with and is no longer unlocked. Press enter to continue.",mNew:"Get new packs",nopacks:"No packs were found, you will now be taken to the pack downloader screen.",mBrowse:"Browse downloaded packs",mHashes:"Rebuild packs folder"}}get(e,s){return void 0!==this.strings[e][s]?this.strings[e][s]:void 0!==this.strings[1][s]?this.strings[1][s]:"-1"}}var s=exports.strings=new e;
},{}],17:[function(require,module,exports) {
!function(){"use strict";var e=function(){this.init()};e.prototype={init:function(){var e=this||t;return e._counter=1e3,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.mobileAutoEnable=!0,e._setup(),e},volume:function(e){var n=this||t;if(e=parseFloat(e),n.ctx||d(),void 0!==e&&e>=0&&e<=1){if(n._volume=e,n._muted)return n;n.usingWebAudio&&n.masterGain.gain.setValueAtTime(e,t.ctx.currentTime);for(var o=0;o<n._howls.length;o++)if(!n._howls[o]._webAudio)for(var r=n._howls[o]._getSoundIds(),i=0;i<r.length;i++){var a=n._howls[o]._soundById(r[i]);a&&a._node&&(a._node.volume=a._volume*e)}return n}return n._volume},mute:function(e){var n=this||t;n.ctx||d(),n._muted=e,n.usingWebAudio&&n.masterGain.gain.setValueAtTime(e?0:n._volume,t.ctx.currentTime);for(var o=0;o<n._howls.length;o++)if(!n._howls[o]._webAudio)for(var r=n._howls[o]._getSoundIds(),i=0;i<r.length;i++){var a=n._howls[o]._soundById(r[i]);a&&a._node&&(a._node.muted=!!e||a._muted)}return n},unload:function(){for(var e=this||t,n=e._howls.length-1;n>=0;n--)e._howls[n].unload();return e.usingWebAudio&&e.ctx&&void 0!==e.ctx.close&&(e.ctx.close(),e.ctx=null,d()),e},codecs:function(e){return(this||t)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||t;if(e.state=e.ctx&&e.ctx.state||"running",e._autoSuspend(),!e.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(e._canPlayEvent="canplay")}catch(t){e.noAudio=!0}else e.noAudio=!0;try{(new Audio).muted&&(e.noAudio=!0)}catch(e){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||t,n=null;try{n="undefined"!=typeof Audio?new Audio:null}catch(t){return e}if(!n||"function"!=typeof n.canPlayType)return e;var o=n.canPlayType("audio/mpeg;").replace(/^no$/,""),r=e._navigator&&e._navigator.userAgent.match(/OPR\/([0-6].)/g),i=r&&parseInt(r[0].split("/")[1],10)<33;return e._codecs={mp3:!(i||!o&&!n.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!o,opus:!!n.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!n.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!n.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!n.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!n.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!n.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(n.canPlayType("audio/x-m4a;")||n.canPlayType("audio/m4a;")||n.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(n.canPlayType("audio/x-mp4;")||n.canPlayType("audio/mp4;")||n.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!n.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!n.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!n.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(n.canPlayType("audio/x-flac;")||n.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_enableMobileAudio:function(){var e=this||t,n=/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi/i.test(e._navigator&&e._navigator.userAgent),o=!!("ontouchend"in window||e._navigator&&e._navigator.maxTouchPoints>0||e._navigator&&e._navigator.msMaxTouchPoints>0);if(!e._mobileEnabled&&e.ctx&&(n||o)){e._mobileEnabled=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var r=function(){t._autoResume();var n=e.ctx.createBufferSource();n.buffer=e._scratchBuffer,n.connect(e.ctx.destination),void 0===n.start?n.noteOn(0):n.start(0),"function"==typeof e.ctx.resume&&e.ctx.resume(),n.onended=function(){n.disconnect(0),e._mobileEnabled=!0,e.mobileAutoEnable=!1,document.removeEventListener("touchstart",r,!0),document.removeEventListener("touchend",r,!0)}};return document.addEventListener("touchstart",r,!0),document.addEventListener("touchend",r,!0),e}},_autoSuspend:function(){var e=this;if(e.autoSuspend&&e.ctx&&void 0!==e.ctx.suspend&&t.usingWebAudio){for(var n=0;n<e._howls.length;n++)if(e._howls[n]._webAudio)for(var o=0;o<e._howls[n]._sounds.length;o++)if(!e._howls[n]._sounds[o]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout(function(){e.autoSuspend&&(e._suspendTimer=null,e.state="suspending",e.ctx.suspend().then(function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())}))},3e4),e}},_autoResume:function(){var e=this;if(e.ctx&&void 0!==e.ctx.resume&&t.usingWebAudio)return"running"===e.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state?(e.ctx.resume().then(function(){e.state="running";for(var t=0;t<e._howls.length;t++)e._howls[t]._emit("resume")}),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var t=new e,n=function(e){e.src&&0!==e.src.length?this.init(e):console.error("An array of source files must be passed with any new Howl.")};n.prototype={init:function(e){var n=this;return t.ctx||d(),n._autoplay=e.autoplay||!1,n._format="string"!=typeof e.format?e.format:[e.format],n._html5=e.html5||!1,n._muted=e.mute||!1,n._loop=e.loop||!1,n._pool=e.pool||5,n._preload="boolean"!=typeof e.preload||e.preload,n._rate=e.rate||1,n._sprite=e.sprite||{},n._src="string"!=typeof e.src?e.src:[e.src],n._volume=void 0!==e.volume?e.volume:1,n._xhrWithCredentials=e.xhrWithCredentials||!1,n._duration=0,n._state="unloaded",n._sounds=[],n._endTimers={},n._queue=[],n._playLock=!1,n._onend=e.onend?[{fn:e.onend}]:[],n._onfade=e.onfade?[{fn:e.onfade}]:[],n._onload=e.onload?[{fn:e.onload}]:[],n._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],n._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],n._onpause=e.onpause?[{fn:e.onpause}]:[],n._onplay=e.onplay?[{fn:e.onplay}]:[],n._onstop=e.onstop?[{fn:e.onstop}]:[],n._onmute=e.onmute?[{fn:e.onmute}]:[],n._onvolume=e.onvolume?[{fn:e.onvolume}]:[],n._onrate=e.onrate?[{fn:e.onrate}]:[],n._onseek=e.onseek?[{fn:e.onseek}]:[],n._onresume=[],n._webAudio=t.usingWebAudio&&!n._html5,void 0!==t.ctx&&t.ctx&&t.mobileAutoEnable&&t._enableMobileAudio(),t._howls.push(n),n._autoplay&&n._queue.push({event:"play",action:function(){n.play()}}),n._preload&&n.load(),n},load:function(){var e=null;if(t.noAudio)this._emit("loaderror",null,"No audio support.");else{"string"==typeof this._src&&(this._src=[this._src]);for(var n=0;n<this._src.length;n++){var r,a;if(this._format&&this._format[n])r=this._format[n];else{if("string"!=typeof(a=this._src[n])){this._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(r=/^data:audio\/([^;,]+);/i.exec(a))||(r=/\.([^.]+)$/.exec(a.split("?",1)[0])),r&&(r=r[1].toLowerCase())}if(r||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),r&&t.codecs(r)){e=this._src[n];break}}if(e)return this._src=e,this._state="loading","https:"===window.location.protocol&&"http:"===e.slice(0,5)&&(this._html5=!0,this._webAudio=!1),new o(this),this._webAudio&&i(this),this;this._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(e,n){var o=this,r=null;if("number"==typeof e)r=e,e=null;else{if("string"==typeof e&&"loaded"===o._state&&!o._sprite[e])return null;if(void 0===e){e="__default";for(var i=0,a=0;a<o._sounds.length;a++)o._sounds[a]._paused&&!o._sounds[a]._ended&&(i++,r=o._sounds[a]._id);1===i?e=null:r=null}}var s=r?o._soundById(r):o._inactiveSound();if(!s)return null;if(r&&!e&&(e=s._sprite||"__default"),"loaded"!==o._state){s._sprite=e,s._ended=!1;var u=s._id;return o._queue.push({event:"play",action:function(){o.play(u)}}),u}if(r&&!s._paused)return n||o._loadQueue("play"),s._id;o._webAudio&&t._autoResume();var d=Math.max(0,s._seek>0?s._seek:o._sprite[e][0]/1e3),_=Math.max(0,(o._sprite[e][0]+o._sprite[e][1])/1e3-d),l=1e3*_/Math.abs(s._rate);s._paused=!1,s._ended=!1,s._sprite=e,s._seek=d,s._start=o._sprite[e][0]/1e3,s._stop=(o._sprite[e][0]+o._sprite[e][1])/1e3,s._loop=!(!s._loop&&!o._sprite[e][2]);var c=s._node;if(o._webAudio){var p=function(){o._refreshBuffer(s);var e=s._muted||o._muted?0:s._volume;c.gain.setValueAtTime(e,t.ctx.currentTime),s._playStart=t.ctx.currentTime,void 0===c.bufferSource.start?s._loop?c.bufferSource.noteGrainOn(0,d,86400):c.bufferSource.noteGrainOn(0,d,_):s._loop?c.bufferSource.start(0,d,86400):c.bufferSource.start(0,d,_),l!==1/0&&(o._endTimers[s._id]=setTimeout(o._ended.bind(o,s),l)),n||setTimeout(function(){o._emit("play",s._id)},0)};"running"===t.state?p():(o.once("resume",p),o._clearTimer(s._id))}else{var f=function(){c.currentTime=d,c.muted=s._muted||o._muted||t._muted||c.muted,c.volume=s._volume*t.volume(),c.playbackRate=s._rate;try{var r=c.play();if("undefined"!=typeof Promise&&r instanceof Promise){o._playLock=!0;var i=function(){o._playLock=!1,n||o._emit("play",s._id)};r.then(i,i)}else n||o._emit("play",s._id);if(c.paused)return void o._emit("playerror",s._id,"Playback was unable to start. This is most commonly an issue on mobile devices where playback was not within a user interaction.");"__default"!==e?o._endTimers[s._id]=setTimeout(o._ended.bind(o,s),l):(o._endTimers[s._id]=function(){o._ended(s),c.removeEventListener("ended",o._endTimers[s._id],!1)},c.addEventListener("ended",o._endTimers[s._id],!1))}catch(e){o._emit("playerror",s._id,e)}},h=window&&window.ejecta||!c.readyState&&t._navigator.isCocoonJS;if(c.readyState>=3||h)f();else{var m=function(){f(),c.removeEventListener(t._canPlayEvent,m,!1)};c.addEventListener(t._canPlayEvent,m,!1),o._clearTimer(s._id)}}return s._id},pause:function(e){var t=this;if("loaded"!==t._state||t._playLock)return t._queue.push({event:"pause",action:function(){t.pause(e)}}),t;for(var n=t._getSoundIds(e),o=0;o<n.length;o++){t._clearTimer(n[o]);var r=t._soundById(n[o]);if(r&&!r._paused&&(r._seek=t.seek(n[o]),r._rateSeek=0,r._paused=!0,t._stopFade(n[o]),r._node))if(t._webAudio){if(!r._node.bufferSource)continue;void 0===r._node.bufferSource.stop?r._node.bufferSource.noteOff(0):r._node.bufferSource.stop(0),t._cleanBuffer(r._node)}else isNaN(r._node.duration)&&r._node.duration!==1/0||r._node.pause();arguments[1]||t._emit("pause",r?r._id:null)}return t},stop:function(e,t){var n=this;if("loaded"!==n._state)return n._queue.push({event:"stop",action:function(){n.stop(e)}}),n;for(var o=n._getSoundIds(e),r=0;r<o.length;r++){n._clearTimer(o[r]);var i=n._soundById(o[r]);i&&(i._seek=i._start||0,i._rateSeek=0,i._paused=!0,i._ended=!0,n._stopFade(o[r]),i._node&&(n._webAudio?i._node.bufferSource&&(void 0===i._node.bufferSource.stop?i._node.bufferSource.noteOff(0):i._node.bufferSource.stop(0),n._cleanBuffer(i._node)):isNaN(i._node.duration)&&i._node.duration!==1/0||(i._node.currentTime=i._start||0,i._node.pause())),t||n._emit("stop",i._id))}return n},mute:function(e,n){var o=this;if("loaded"!==o._state)return o._queue.push({event:"mute",action:function(){o.mute(e,n)}}),o;if(void 0===n){if("boolean"!=typeof e)return o._muted;o._muted=e}for(var r=o._getSoundIds(n),i=0;i<r.length;i++){var a=o._soundById(r[i]);a&&(a._muted=e,a._interval&&o._stopFade(a._id),o._webAudio&&a._node?a._node.gain.setValueAtTime(e?0:a._volume,t.ctx.currentTime):a._node&&(a._node.muted=!!t._muted||e),o._emit("mute",a._id))}return o},volume:function(){var e,n,o,r=this,i=arguments;if(0===i.length)return r._volume;if(1===i.length||2===i.length&&void 0===i[1]?r._getSoundIds().indexOf(i[0])>=0?n=parseInt(i[0],10):e=parseFloat(i[0]):i.length>=2&&(e=parseFloat(i[0]),n=parseInt(i[1],10)),!(void 0!==e&&e>=0&&e<=1))return(o=n?r._soundById(n):r._sounds[0])?o._volume:0;if("loaded"!==r._state)return r._queue.push({event:"volume",action:function(){r.volume.apply(r,i)}}),r;void 0===n&&(r._volume=e),n=r._getSoundIds(n);for(var a=0;a<n.length;a++)(o=r._soundById(n[a]))&&(o._volume=e,i[2]||r._stopFade(n[a]),r._webAudio&&o._node&&!o._muted?o._node.gain.setValueAtTime(e,t.ctx.currentTime):o._node&&!o._muted&&(o._node.volume=e*t.volume()),r._emit("volume",o._id));return r},fade:function(e,n,o,r){var i=this;if("loaded"!==i._state)return i._queue.push({event:"fade",action:function(){i.fade(e,n,o,r)}}),i;i.volume(e,r);for(var a=i._getSoundIds(r),s=0;s<a.length;s++){var u=i._soundById(a[s]);if(u){if(r||i._stopFade(a[s]),i._webAudio&&!u._muted){var d=t.ctx.currentTime,_=d+o/1e3;u._volume=e,u._node.gain.setValueAtTime(e,d),u._node.gain.linearRampToValueAtTime(n,_)}i._startFadeInterval(u,e,n,o,a[s],void 0===r)}}return i},_startFadeInterval:function(e,t,n,o,r,i){var a=this,s=t,u=n-t,d=Math.abs(u/.01),_=Math.max(4,d>0?o/d:o),l=Date.now();e._fadeTo=n,e._interval=setInterval(function(){var r=(Date.now()-l)/o;l=Date.now(),s+=u*r,s=Math.max(0,s),s=Math.min(1,s),s=Math.round(100*s)/100,a._webAudio?e._volume=s:a.volume(s,e._id,!0),i&&(a._volume=s),(n<t&&s<=n||n>t&&s>=n)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,a.volume(n,e._id),a._emit("fade",e._id))},_)},_stopFade:function(e){var n=this._soundById(e);return n&&n._interval&&(this._webAudio&&n._node.gain.cancelScheduledValues(t.ctx.currentTime),clearInterval(n._interval),n._interval=null,this.volume(n._fadeTo,e),n._fadeTo=null,this._emit("fade",e)),this},loop:function(){var e,t,n,o=arguments;if(0===o.length)return this._loop;if(1===o.length){if("boolean"!=typeof o[0])return!!(n=this._soundById(parseInt(o[0],10)))&&n._loop;e=o[0],this._loop=e}else 2===o.length&&(e=o[0],t=parseInt(o[1],10));for(var r=this._getSoundIds(t),i=0;i<r.length;i++)(n=this._soundById(r[i]))&&(n._loop=e,this._webAudio&&n._node&&n._node.bufferSource&&(n._node.bufferSource.loop=e,e&&(n._node.bufferSource.loopStart=n._start||0,n._node.bufferSource.loopEnd=n._stop)));return this},rate:function(){var e,n,o,r=this,i=arguments;if(0===i.length)n=r._sounds[0]._id;else if(1===i.length){r._getSoundIds().indexOf(i[0])>=0?n=parseInt(i[0],10):e=parseFloat(i[0])}else 2===i.length&&(e=parseFloat(i[0]),n=parseInt(i[1],10));if("number"!=typeof e)return(o=r._soundById(n))?o._rate:r._rate;if("loaded"!==r._state)return r._queue.push({event:"rate",action:function(){r.rate.apply(r,i)}}),r;void 0===n&&(r._rate=e),n=r._getSoundIds(n);for(var a=0;a<n.length;a++)if(o=r._soundById(n[a])){o._rateSeek=r.seek(n[a]),o._playStart=r._webAudio?t.ctx.currentTime:o._playStart,o._rate=e,r._webAudio&&o._node&&o._node.bufferSource?o._node.bufferSource.playbackRate.setValueAtTime(e,t.ctx.currentTime):o._node&&(o._node.playbackRate=e);var s=r.seek(n[a]),u=1e3*((r._sprite[o._sprite][0]+r._sprite[o._sprite][1])/1e3-s)/Math.abs(o._rate);!r._endTimers[n[a]]&&o._paused||(r._clearTimer(n[a]),r._endTimers[n[a]]=setTimeout(r._ended.bind(r,o),u)),r._emit("rate",o._id)}return r},seek:function(){var e,n,o=this,r=arguments;if(0===r.length)n=o._sounds[0]._id;else if(1===r.length){o._getSoundIds().indexOf(r[0])>=0?n=parseInt(r[0],10):o._sounds.length&&(n=o._sounds[0]._id,e=parseFloat(r[0]))}else 2===r.length&&(e=parseFloat(r[0]),n=parseInt(r[1],10));if(void 0===n)return o;if("loaded"!==o._state)return o._queue.push({event:"seek",action:function(){o.seek.apply(o,r)}}),o;var i=o._soundById(n);if(i){if(!("number"==typeof e&&e>=0)){if(o._webAudio){var a=o.playing(n)?t.ctx.currentTime-i._playStart:0,s=i._rateSeek?i._rateSeek-i._seek:0;return i._seek+(s+a*Math.abs(i._rate))}return i._node.currentTime}var u=o.playing(n);if(u&&o.pause(n,!0),i._seek=e,i._ended=!1,o._clearTimer(n),u&&o.play(n,!0),!o._webAudio&&i._node&&(i._node.currentTime=e),u&&!o._webAudio){var d=function(){o._playLock?setTimeout(d,0):o._emit("seek",n)};setTimeout(d,0)}else o._emit("seek",n)}return o},playing:function(e){if("number"==typeof e){var t=this._soundById(e);return!!t&&!t._paused}for(var n=0;n<this._sounds.length;n++)if(!this._sounds[n]._paused)return!0;return!1},duration:function(e){var t=this._duration,n=this._soundById(e);return n&&(t=this._sprite[n._sprite][1]/1e3),t},state:function(){return this._state},unload:function(){for(var e=this,n=e._sounds,o=0;o<n.length;o++){if(n[o]._paused||e.stop(n[o]._id),!e._webAudio)/MSIE |Trident\//.test(t._navigator&&t._navigator.userAgent)||(n[o]._node.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"),n[o]._node.removeEventListener("error",n[o]._errorFn,!1),n[o]._node.removeEventListener(t._canPlayEvent,n[o]._loadFn,!1);delete n[o]._node,e._clearTimer(n[o]._id);var i=t._howls.indexOf(e);i>=0&&t._howls.splice(i,1)}var a=!0;for(o=0;o<t._howls.length;o++)if(t._howls[o]._src===e._src){a=!1;break}return r&&a&&delete r[e._src],t.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,t,n,o){var r=this["_on"+e];return"function"==typeof t&&r.push(o?{id:n,fn:t,once:o}:{id:n,fn:t}),this},off:function(e,t,n){var o=this["_on"+e],r=0;if("number"==typeof t&&(n=t,t=null),t||n)for(r=0;r<o.length;r++){var i=n===o[r].id;if(t===o[r].fn&&i||!t&&i){o.splice(r,1);break}}else if(e)this["_on"+e]=[];else{var a=Object.keys(this);for(r=0;r<a.length;r++)0===a[r].indexOf("_on")&&Array.isArray(this[a[r]])&&(this[a[r]]=[])}return this},once:function(e,t,n){return this.on(e,t,n,1),this},_emit:function(e,t,n){for(var o=this["_on"+e],r=o.length-1;r>=0;r--)o[r].id&&o[r].id!==t&&"load"!==e||(setTimeout(function(e){e.call(this,t,n)}.bind(this,o[r].fn),0),o[r].once&&this.off(e,o[r].fn,o[r].id));return this._loadQueue(e),this},_loadQueue:function(e){if(this._queue.length>0){var t=this._queue[0];t.event===e&&(this._queue.shift(),this._loadQueue()),e||t.action()}return this},_ended:function(e){var n=e._sprite;if(!this._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(this._ended.bind(this,e),100),this;var o=!(!e._loop&&!this._sprite[n][2]);if(this._emit("end",e._id),!this._webAudio&&o&&this.stop(e._id,!0).play(e._id),this._webAudio&&o){this._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=t.ctx.currentTime;var r=1e3*(e._stop-e._start)/Math.abs(e._rate);this._endTimers[e._id]=setTimeout(this._ended.bind(this,e),r)}return this._webAudio&&!o&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,this._clearTimer(e._id),this._cleanBuffer(e._node),t._autoSuspend()),this._webAudio||o||this.stop(e._id),this},_clearTimer:function(e){if(this._endTimers[e]){if("function"!=typeof this._endTimers[e])clearTimeout(this._endTimers[e]);else{var t=this._soundById(e);t&&t._node&&t._node.removeEventListener("ended",this._endTimers[e],!1)}delete this._endTimers[e]}return this},_soundById:function(e){for(var t=0;t<this._sounds.length;t++)if(e===this._sounds[t]._id)return this._sounds[t];return null},_inactiveSound:function(){this._drain();for(var e=0;e<this._sounds.length;e++)if(this._sounds[e]._ended)return this._sounds[e].reset();return new o(this)},_drain:function(){var e=this._pool,t=0,n=0;if(!(this._sounds.length<e)){for(n=0;n<this._sounds.length;n++)this._sounds[n]._ended&&t++;for(n=this._sounds.length-1;n>=0;n--){if(t<=e)return;this._sounds[n]._ended&&(this._webAudio&&this._sounds[n]._node&&this._sounds[n]._node.disconnect(0),this._sounds.splice(n,1),t--)}}},_getSoundIds:function(e){if(void 0===e){for(var t=[],n=0;n<this._sounds.length;n++)t.push(this._sounds[n]._id);return t}return[e]},_refreshBuffer:function(e){return e._node.bufferSource=t.ctx.createBufferSource(),e._node.bufferSource.buffer=r[this._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,t.ctx.currentTime),this},_cleanBuffer:function(e){if(t._scratchBuffer){e.bufferSource.onended=null,e.bufferSource.disconnect(0);try{e.bufferSource.buffer=t._scratchBuffer}catch(e){}}return e.bufferSource=null,this}};var o=function(e){this._parent=e,this.init()};o.prototype={init:function(){var e=this._parent;return this._muted=e._muted,this._loop=e._loop,this._volume=e._volume,this._rate=e._rate,this._seek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++t._counter,e._sounds.push(this),this.create(),this},create:function(){var e=this._parent,n=t._muted||this._muted||this._parent._muted?0:this._volume;return e._webAudio?(this._node=void 0===t.ctx.createGain?t.ctx.createGainNode():t.ctx.createGain(),this._node.gain.setValueAtTime(n,t.ctx.currentTime),this._node.paused=!0,this._node.connect(t.masterGain)):(this._node=new Audio,this._errorFn=this._errorListener.bind(this),this._node.addEventListener("error",this._errorFn,!1),this._loadFn=this._loadListener.bind(this),this._node.addEventListener(t._canPlayEvent,this._loadFn,!1),this._node.src=e._src,this._node.preload="auto",this._node.volume=n*t.volume(),this._node.load()),this},reset:function(){var e=this._parent;return this._muted=e._muted,this._loop=e._loop,this._volume=e._volume,this._rate=e._rate,this._seek=0,this._rateSeek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++t._counter,this},_errorListener:function(){this._parent._emit("loaderror",this._id,this._node.error?this._node.error.code:0),this._node.removeEventListener("error",this._errorFn,!1)},_loadListener:function(){var e=this._parent;e._duration=Math.ceil(10*this._node.duration)/10,0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue()),this._node.removeEventListener(t._canPlayEvent,this._loadFn,!1)}};var r={},i=function(e){var t=e._src;if(r[t])return e._duration=r[t].duration,void u(e);if(/^data:[^;]+;base64,/.test(t)){for(var n=atob(t.split(",")[1]),o=new Uint8Array(n.length),i=0;i<n.length;++i)o[i]=n.charCodeAt(i);s(o.buffer,e)}else{var d=new XMLHttpRequest;d.open("GET",t,!0),d.withCredentials=e._xhrWithCredentials,d.responseType="arraybuffer",d.onload=function(){var t=(d.status+"")[0];"0"===t||"2"===t||"3"===t?s(d.response,e):e._emit("loaderror",null,"Failed loading audio file with status: "+d.status+".")},d.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete r[t],e.load())},a(d)}},a=function(e){try{e.send()}catch(t){e.onerror()}},s=function(e,n){t.ctx.decodeAudioData(e,function(e){e&&n._sounds.length>0&&(r[n._src]=e,u(n,e))},function(){n._emit("loaderror",null,"Decoding audio data failed.")})},u=function(e,t){t&&!e._duration&&(e._duration=t.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},d=function(){try{"undefined"!=typeof AudioContext?t.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?t.ctx=new webkitAudioContext:t.usingWebAudio=!1}catch(e){t.usingWebAudio=!1}var e=/iP(hone|od|ad)/.test(t._navigator&&t._navigator.platform),n=t._navigator&&t._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),o=n?parseInt(n[1],10):null;if(e&&o&&o<9){var r=/safari/.test(t._navigator&&t._navigator.userAgent.toLowerCase());(t._navigator&&t._navigator.standalone&&!r||t._navigator&&!t._navigator.standalone&&!r)&&(t.usingWebAudio=!1)}t.usingWebAudio&&(t.masterGain=void 0===t.ctx.createGain?t.ctx.createGainNode():t.ctx.createGain(),t.masterGain.gain.setValueAtTime(t._muted?0:1,t.ctx.currentTime),t.masterGain.connect(t.ctx.destination)),t._setup()};"function"==typeof define&&define.amd&&define([],function(){return{Howler:t,Howl:n}}),"undefined"!=typeof window?(window.HowlerGlobal=e,window.Howler=t,window.Howl=n,window.Sound=o):"undefined"!=typeof global&&(global.HowlerGlobal=e,global.Howler=t,global.Howl=n,global.Sound=o)}(),function(){"use strict";var e;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){if(!this.ctx||!this.ctx.listener)return this;for(var t=this._howls.length-1;t>=0;t--)this._howls[t].stereo(e);return this},HowlerGlobal.prototype.pos=function(e,t,n){return this.ctx&&this.ctx.listener?(t="number"!=typeof t?this._pos[1]:t,n="number"!=typeof n?this._pos[2]:n,"number"!=typeof e?this._pos:(this._pos=[e,t,n],this.ctx.listener.setPosition(this._pos[0],this._pos[1],this._pos[2]),this)):this},HowlerGlobal.prototype.orientation=function(e,t,n,o,r,i){if(!this.ctx||!this.ctx.listener)return this;var a=this._orientation;return t="number"!=typeof t?a[1]:t,n="number"!=typeof n?a[2]:n,o="number"!=typeof o?a[3]:o,r="number"!=typeof r?a[4]:r,i="number"!=typeof i?a[5]:i,"number"!=typeof e?a:(this._orientation=[e,t,n,o,r,i],this.ctx.listener.setOrientation(e,t,n,o,r,i),this)},Howl.prototype.init=(e=Howl.prototype.init,function(t){return this._orientation=t.orientation||[1,0,0],this._stereo=t.stereo||null,this._pos=t.pos||null,this._pannerAttr={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:360,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:360,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:0,distanceModel:void 0!==t.distanceModel?t.distanceModel:"inverse",maxDistance:void 0!==t.maxDistance?t.maxDistance:1e4,panningModel:void 0!==t.panningModel?t.panningModel:"HRTF",refDistance:void 0!==t.refDistance?t.refDistance:1,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:1},this._onstereo=t.onstereo?[{fn:t.onstereo}]:[],this._onpos=t.onpos?[{fn:t.onpos}]:[],this._onorientation=t.onorientation?[{fn:t.onorientation}]:[],e.call(this,t)}),Howl.prototype.stereo=function(e,n){var o=this;if(!o._webAudio)return o;if("loaded"!==o._state)return o._queue.push({event:"stereo",action:function(){o.stereo(e,n)}}),o;var r=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===n){if("number"!=typeof e)return o._stereo;o._stereo=e,o._pos=[e,0,0]}for(var i=o._getSoundIds(n),a=0;a<i.length;a++){var s=o._soundById(i[a]);if(s){if("number"!=typeof e)return s._stereo;s._stereo=e,s._pos=[e,0,0],s._node&&(s._pannerAttr.panningModel="equalpower",s._panner&&s._panner.pan||t(s,r),"spatial"===r?s._panner.setPosition(e,0,0):s._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),o._emit("stereo",s._id)}}return o},Howl.prototype.pos=function(e,n,o,r){var i=this;if(!i._webAudio)return i;if("loaded"!==i._state)return i._queue.push({event:"pos",action:function(){i.pos(e,n,o,r)}}),i;if(n="number"!=typeof n?0:n,o="number"!=typeof o?-.5:o,void 0===r){if("number"!=typeof e)return i._pos;i._pos=[e,n,o]}for(var a=i._getSoundIds(r),s=0;s<a.length;s++){var u=i._soundById(a[s]);if(u){if("number"!=typeof e)return u._pos;u._pos=[e,n,o],u._node&&(u._panner&&!u._panner.pan||t(u,"spatial"),u._panner.setPosition(e,n,o)),i._emit("pos",u._id)}}return i},Howl.prototype.orientation=function(e,n,o,r){var i=this;if(!i._webAudio)return i;if("loaded"!==i._state)return i._queue.push({event:"orientation",action:function(){i.orientation(e,n,o,r)}}),i;if(n="number"!=typeof n?i._orientation[1]:n,o="number"!=typeof o?i._orientation[2]:o,void 0===r){if("number"!=typeof e)return i._orientation;i._orientation=[e,n,o]}for(var a=i._getSoundIds(r),s=0;s<a.length;s++){var u=i._soundById(a[s]);if(u){if("number"!=typeof e)return u._orientation;u._orientation=[e,n,o],u._node&&(u._panner||(u._pos||(u._pos=i._pos||[0,0,-.5]),t(u,"spatial")),u._panner.setOrientation(e,n,o)),i._emit("orientation",u._id)}}return i},Howl.prototype.pannerAttr=function(){var e,n,o,r=arguments;if(!this._webAudio)return this;if(0===r.length)return this._pannerAttr;if(1===r.length){if("object"!=typeof r[0])return(o=this._soundById(parseInt(r[0],10)))?o._pannerAttr:this._pannerAttr;e=r[0],void 0===n&&(e.pannerAttr||(e.pannerAttr={coneInnerAngle:e.coneInnerAngle,coneOuterAngle:e.coneOuterAngle,coneOuterGain:e.coneOuterGain,distanceModel:e.distanceModel,maxDistance:e.maxDistance,refDistance:e.refDistance,rolloffFactor:e.rolloffFactor,panningModel:e.panningModel}),this._pannerAttr={coneInnerAngle:void 0!==e.pannerAttr.coneInnerAngle?e.pannerAttr.coneInnerAngle:this._coneInnerAngle,coneOuterAngle:void 0!==e.pannerAttr.coneOuterAngle?e.pannerAttr.coneOuterAngle:this._coneOuterAngle,coneOuterGain:void 0!==e.pannerAttr.coneOuterGain?e.pannerAttr.coneOuterGain:this._coneOuterGain,distanceModel:void 0!==e.pannerAttr.distanceModel?e.pannerAttr.distanceModel:this._distanceModel,maxDistance:void 0!==e.pannerAttr.maxDistance?e.pannerAttr.maxDistance:this._maxDistance,refDistance:void 0!==e.pannerAttr.refDistance?e.pannerAttr.refDistance:this._refDistance,rolloffFactor:void 0!==e.pannerAttr.rolloffFactor?e.pannerAttr.rolloffFactor:this._rolloffFactor,panningModel:void 0!==e.pannerAttr.panningModel?e.pannerAttr.panningModel:this._panningModel})}else 2===r.length&&(e=r[0],n=parseInt(r[1],10));for(var i=this._getSoundIds(n),a=0;a<i.length;a++)if(o=this._soundById(i[a])){var s=o._pannerAttr;s={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:s.coneInnerAngle,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:s.coneOuterAngle,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:s.coneOuterGain,distanceModel:void 0!==e.distanceModel?e.distanceModel:s.distanceModel,maxDistance:void 0!==e.maxDistance?e.maxDistance:s.maxDistance,refDistance:void 0!==e.refDistance?e.refDistance:s.refDistance,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:s.rolloffFactor,panningModel:void 0!==e.panningModel?e.panningModel:s.panningModel};var u=o._panner;u?(u.coneInnerAngle=s.coneInnerAngle,u.coneOuterAngle=s.coneOuterAngle,u.coneOuterGain=s.coneOuterGain,u.distanceModel=s.distanceModel,u.maxDistance=s.maxDistance,u.refDistance=s.refDistance,u.rolloffFactor=s.rolloffFactor,u.panningModel=s.panningModel):(o._pos||(o._pos=this._pos||[0,0,-.5]),t(o,"spatial"))}return this},Sound.prototype.init=function(e){return function(){var t=this._parent;this._orientation=t._orientation,this._stereo=t._stereo,this._pos=t._pos,this._pannerAttr=t._pannerAttr,e.call(this),this._stereo?t.stereo(this._stereo):this._pos&&t.pos(this._pos[0],this._pos[1],this._pos[2],this._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var t=this._parent;return this._orientation=t._orientation,this._pos=t._pos,this._pannerAttr=t._pannerAttr,e.call(this)}}(Sound.prototype.reset);var t=function(e,t){"spatial"===(t=t||"spatial")?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}}(),"undefined"!=typeof exports&&(exports.Howler=Howler,exports.Howl=Howl);
},{}],13:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SoundSource=void 0;var t=require("./howler"),s=require("./soundObject.js");class e{constructor(t,e=0,i=0,h=0,o=!0){this.x=e,this.y=i,this.z=h,this.loop=o,this.sound=s.so.create(t),this.sound.loop=o,this.sound.pos(this.x,this.y,this.z),this.rate=1,this.speed=0,this.minRate=.8,this.maxRate=1.2,this.toDestroy=!1,this.rateShiftSpeed=.015,this.sound.currentPosition=0}play(){this.sound.play()}pos(t,s,e){this.x=t,this.y=s,this.z=e,this.sound.pos(this.x,this.y,this.z)}update(){}setDoppler(t,s,e){if(s>=0)if(-1==e){var i=44100*(1-(s+=this.speed)/240);this.rate=i/44100}else{i=44100/(1-(s+=this.speed)/240);this.rate=i/44100}else this.rate=1;this.rate>this.sound.playbackRate+this.rateShiftSpeed?this.sound.playbackRate+=this.rateShiftSpeed:this.rate<this.sound.playbackRate-this.rateShiftSpeed&&(this.sound.playbackRate-=this.rateShiftSpeed)}setSpeed(t){this.speed=t}destroy(){this.sound.unload(),this.toDestroy=!0}}exports.SoundSource=e;
},{"./howler":17,"./soundObject.js":10}],8:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SoundHandler=void 0;var t=require("./soundSource.js"),s=require("./soundObject.js");class i{constructor(t=!1){this.staticSounds=[],this.dynamicSounds=[],this.currentDynamicSound=0,this.maxDynamicSounds=512,this.currentStaticSound=0,this.maxStaticSounds=512,this.reuseSounds=!0,this.x=0,this.y=0,this.z=0,this.directional=t}playStatic(t,s=1,i=-1){return(i=-1)&&(i=this.findFreeStaticSlot()),this.staticSounds[i]=new n(t,this.directional),1==s&&(this.staticSounds[i].sound.loop=!0),this.staticSounds[i].sound.play(),console.log("slot "+i),i}findFreeStaticSlot(){for(let t=0;t<this.maxStaticSounds;t++)if(-1==this.staticSounds[t]||void 0===this.staticSounds[t])return t;return this.currentStaticSound<this.maxStaticSounds?(this.currentStaticSound++,this.currentStaticSound):(this.currentStaticSound=0,this.currentStaticSound)}findFreeDynamicSlot(){for(let t=0;t<this.maxDynamicSounds;t++)if(-1==this.dynamicSounds[t]||void 0===this.dynamicSounds[t])return t;return this.currentDynamicSound<this.maxDynamicSounds?(this.currentDynamicSound++,this.currentDynamicSound):(this.currentDynamicSound=0,this.currentDynamicSound)}findDynamicSound(t){for(let s=0;s<this.dynamicSounds.length;s++)if(this.dynamicSounds[s].file==t)return s;return-1}play(t){let s=0,i=0;this.reuseSounds&&(s=this.findDynamicSound(t),i=!0),-1!=s&&0!=this.reuseSounds||(s=this.findFreeDynamicSlot(),i=!1),void 0===this.dynamicSounds[s]?0==i&&(this.dynamicSounds[s]=new n(t,this.directional),console.log("Created sound")):0==i&&(this.dynamicSounds[s].sound.destroy(),this.dynamicSounds[s]=new n(t,directional),console.log("Destroyed and reloaded")),console.log("playing sound"),this.dynamicSounds[s].sound.play()}update(t){if(1==this.directional)for(let s=0;s<this.dynamicSounds.length;s++)this.dynamicSounds[s].sound.pos(t.x,t.y,t.z)}destroy(){for(var t=0;t<this.dynamicSounds.length;t++)console.log("destroying"+t),this.dynamicSounds[t].destroy(),this.dynamicSounds.splice(t,1);for(t=0;t<this.staticSounds.length;t++)this.staticSounds[t].destroy(),console.log("destroying"+t),this.staticSounds.splice(t,1)}}class n{constructor(i,n=!1){this.file=i,this.threeD=n,1==this.threeD?this.sound=new t.SoundSource(i,0,0,0):this.sound=s.so.create(i)}destroy(){this.sound.destroy()}}exports.SoundHandler=i;
},{"./soundSource.js":13,"./soundObject.js":10}],7:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class t{distance3D(t,e,r,a,n,s){return Math.sqrt((a-t)*(a-t)+(n-e)*(n-e)+(s-r)*(s-r))}distance(t,e,r,a){return Math.sqrt((t-r)*(t-r)+(e-a)*(e-a))}calculateAngle(t,e,r,a){var n=Math.atan2(a-e,r-t);return n=n>=0?0:2*Math.PI+n}isCollide3D(t,e){return t.x<=e.x+e.width&&t.x+t.width>=e.x&&t.y<=e.y+e.height&&t.y+t.height>=e.y&&t.z<=e.z+e.depth&&t.z+t.depth>=e.z}randomInt(t,e){return Math.floor(Math.random()*(e-t+1))+t}getRandomArbitrary(t,e){return Math.random()*(e-t)+t}sleep(t){return new Promise(e=>setTimeout(e,t))}percent(t,e){return 100*t/e}}var e=exports.utils=new t;
},{}],3:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.KeyboardInput=void 0;var e=require("jquery"),s=h(e),t=require("./tts");function h(e){return e&&e.__esModule?e:{default:e}}class r{constructor(){this.keyDown=[],this.justPressed=[],this.chars=[],this.justReleased=[],this.justPressedEventCallback=null}init(){var e=this;document.addEventListener("keydown",function(s){e.handleKeyDown(s)}),document.addEventListener("keyup",function(s){e.handleKeyUp(s)}),document.addEventListener("keypress",function(s){e.handleChar(s)})}handleKeyDown(e){1==this.keyDown[e.which]&&void 0!==this.keyDown[e.which]||(this.keyDown[e.which]=!0,this.justPressed[e.which]=!0,this.justReleased[e.which]=!1,void 0!==this.justPressedEventCallback&&null!=this.justPressedEventCallback&&this.justPressedEventCallback(e.which))}handleChar(e){""!=String.fromCharCode(e.which)&&(this.chars+=String.fromCharCode(e.which))}handleKeyUp(e){1==this.keyDown[e.which]&&(this.keyDown[e.which]=!1,this.justPressed[e.which]=!1,this.justReleased[e.which]=!0),this.chars=""}isDown(e){return this.keyDown[e]}isJustPressed(e){return 1==this.justPressed[e]&&(this.justPressed[e]=!1,!0)}isJustReleased(e){return!!this.justReleased[e]&&(this.justReleased[e]=!1,!0)}keysDown(){var e=[];return this.keyDown.forEach(function(s,t){s&&e.push(t)}),e}getChars(){var e=this.chars;return this.chars="",e}keysPressed(){var e=[];return this.justPressed.forEach(function(s,t){s&&e.push(t)}),this.justPressed.splice(),e}releaseAllKeys(){}keysReleased(){var e=[];return this.justReleased.forEach(function(s,t){s&&e.push(t)}),this.justReleased.splice(),e}}exports.KeyboardInput=r;
},{"./tts":5}],19:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MenuTypes=exports.MenuItem=void 0;var t=require("./tts");if(void 0===e)var e=new t.TTS;var s={NORMAL:0,SELECTOR:1,SLIDER:2,EDIT:3};class i{constructor(t,e){this.name=e,this.id=t,this.type=s.NORMAL}speak(){e.speak(this.name)}select(){return this.id}}class r extends i{constructor(t,e,i,r=0,n){super(),this.id=t,this.name=e,this.options=i,this.type=s.SELECTOR,this.currentOption=r,this.selectCallback=n}speak(){e.speak(this.name+". Selector. Set to "+this.options[this.currentOption])}increase(){this.currentOption<this.options.length-1&&this.currentOption++,e.speak(this.options[this.currentOption]),void 0!==this.selectCallback&&this.selectCallback(this.options[this.currentOption])}decrease(){this.currentOption>0&&this.currentOption--,e.speak(this.options[this.currentOption]),void 0!==this.selectCallback&&this.selectCallback(this.options[this.currentOption])}select(){return this.id}}class n extends i{constructor(t,e,i,r,n=0){super(),this.id=t,this.name=e,this.minValue=i,this.maxValue=r,this.currentValue=n,this.type=s.SLIDER}speak(){e.speak(this.name+". Slider. Set to "+this.currentValue)}increase(){this.currentValue<this.maxValue&&this.currentValue++,e.speak(this.currentValue)}decrease(){this.currentValue>this.minValue&&this.currentValue--,e.speak(this.currentValue)}select(){return this.id}}class h extends i{constructor(t,e,i=""){super(),this.id=t,this.name=e,this.text=i,this.type=s.EDIT}speak(){e.speak(this.name+". Editable. "+(""==this.text?"Nothing entered.":"Set to "+this.text))}addChar(t){this.text+=t,e.speak(t)}removeChar(){this.text=this.text.substring(0,this.text.length-1),e.speak(this.text)}select(){return this.text}}exports.MenuItem=i,exports.MenuTypes=s;
},{"./tts":5}],16:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Menu=void 0;var e=require("./utilities"),s=require("./strings"),t=require("./tts"),i=require("jquery"),a=o(i),u=require("./soundObject.js"),n=require("./menuItem"),r=require("./keycodes"),h=require("./input");function o(e){return e&&e.__esModule?e:{default:e}}class c{constructor(e,s,t){this.menuData=s,this.cursor=0,this.name=e,this.sndKeyChar=u.so.create("ui/keyChar"),this.sndKeyDelete=u.so.create("ui/keyDelete"),this.sndSliderLeft=u.so.create("ui/menuSliderLeft"),this.sndSliderRight=u.so.create("ui/menuSliderRight"),this.sndBoundary=u.so.create("ui/menuBoundary"),this.sndChoose=u.so.create("ui/menuChoose"),this.sndMove=u.so.create("ui/menuMove"),this.sndOpen=u.so.create("ui/menuOpen"),this.sndSelector=u.so.create("ui/menuSelector"),this.sndWrap=u.so.create("ui/menuWrap"),this.selectCallback=null,void 0!==t&&(this.music=t);document.getElementById("touchArea")}nextItem(){this.cursor<this.menuData.length-1&&this.cursor++,this.sndMove.play(),this.menuData[this.cursor].speak()}previousItem(){this.cursor>0&&this.cursor--,this.sndMove.play(),this.menuData[this.cursor].speak()}increase(){this.menuData[this.cursor].type!=n.MenuTypes.SLIDER&&this.menuData[this.cursor].type!=n.MenuTypes.SELECTOR||(this.menuData[this.cursor].increase(),this.menuData[this.cursor].type==n.MenuTypes.SLIDER?this.sndSliderRight.play():this.sndSelector.play())}decrease(){this.menuData[this.cursor].type!=n.MenuTypes.SLIDER&&this.menuData[this.cursor].type!=n.MenuTypes.SELECTOR||(this.menuData[this.cursor].decrease(),this.menuData[this.cursor].type==n.MenuTypes.SLIDER?this.sndSliderLeft.play():this.sndSelector.play())}insertCharacter(e){this.menuData[this.cursor].type==n.MenuTypes.EDIT&&(this.menuData[this.cursor].addChar(String.fromCharCode(e)),this.sndKeyChar.play())}removeCharacter(){this.menuData[this.cursor].type==n.MenuTypes.EDIT&&(this.menuData[this.cursor].removeChar(),this.sndKeyDelete.play())}handleInput(e){this.insertCharacter(e.which)}destroySounds(){this.sndKeyChar.unload(),this.sndKeyDelete.unload(),this.sndSliderLeft.unload(),this.sndSliderRight.unload(),this.sndBoundary.unload(),this.sndChoose.unload(),this.sndMove.unload(),this.sndOpen.unload(),this.sndSelector.unload(),this.sndWrap.unload(),void 0!==this.music&&this.music.unload()}async fade(){for(var s=this.music.volume;s>0;s-=.06)this.music.volume=s,await e.utils.sleep(50);this.music.unload(),this.unload()}unload(){(0,a.default)(document).off("keydown"),(0,a.default)(document).off("keypress");var e=this;setTimeout(function(){e.destroySounds()},500)}handleKeys(e){switch(e.which){case r.KeyEvent.DOM_VK_RETURN:this.select();break;case r.KeyEvent.DOM_VK_PAGE_UP:this.music.volume+=.03;break;case r.KeyEvent.DOM_VK_PAGE_DOWN:this.music.volume-=.03;break;case r.KeyEvent.DOM_VK_BACK_SPACE:this.removeCharacter();break;case r.KeyEvent.DOM_VK_DOWN:this.nextItem();break;case r.KeyEvent.DOM_VK_UP:this.previousItem();break;case r.KeyEvent.DOM_VK_RIGHT:this.increase();break;case r.KeyEvent.DOM_VK_LEFT:this.decrease()}}run(e){"object"==typeof this.music?(this.music.volume=.5,this.music.loop=!0,this.music.play()):"string"==typeof this.music&&(this.music=u.so.create(this.music),this.music.volume=.5,this.music.loop=!0,this.music.play()),this.selectCallback=e;var s=this;(0,a.default)(document).on("keypress",function(e){s.handleInput(e)}),(0,a.default)(document).on("keydown",function(e){s.handleKeys(e)}),t.speech.speak(this.name),this.sndOpen.play()}handleSwipe(e){3==e&&this.decrease(),4==e&&this.increase(),0==e&&this.previousItem(),1==e&&this.nextItem(),2==e&&this.select()}select(){for(var e=this.menuData[this.cursor].id,s=[],t=0;t<this.menuData.length;t++){var i=null;this.menuData[t].type==n.MenuTypes.SLIDER&&(i={id:this.menuData[t].id,value:this.menuData[t].currentValue,name:this.menuData[t].options[this.menuData[t].currentValue]}),this.menuData[t].type==n.MenuTypes.EDIT&&(i={id:this.menuData[t].id,value:this.menuData[t].text}),this.menuData[t].type==n.MenuTypes.SELECTOR&&(i={id:this.menuData[t].id,value:this.menuData[t].currentOption,name:this.menuData[t].options[this.menuData[t].currentOption]}),s.push(i)}var u={selected:e,cursor:this.cursor,items:s};this.sndChoose.play(),(0,a.default)(document).off("keydown"),(0,a.default)(document).off("keypress"),void 0!==this.music&&this.fade();var r=this;setTimeout(function(){r.selectCallback(u)},700)}}exports.Menu=c;
},{"./utilities":7,"./strings":4,"./tts":5,"./soundObject.js":10,"./menuItem":19,"./keycodes":12,"./input":3}],15:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.mainMenu=u;var e=require("./soundObject"),s=require("./main"),t=require("./stateMachine"),r=require("./strings"),n=require("./menuItem"),a=require("./menu");function u(){var u=new Array;u.push(new n.MenuItem(0,r.strings.get(s.lang,"mStart"))),u.push(new n.MenuItem(1,r.strings.get(s.lang,"mLearn"))),u.push(new n.MenuItem(2,r.strings.get(s.lang,"mBrowse"))),u.push(new n.MenuItem(3,r.strings.get(s.lang,"mHashes")));var i=new a.Menu("main menu",u);e.so.directory="",i.music=s.packdir+"loop",require("fs").existsSync(s.packdir+"select.ogg")&&(i.sndChoose.unload(),i.sndChoose=e.so.create(s.packdir+"select")),i.run(function(r){switch(e.so.directory="./sounds/",r.selected){case 0:t.st.setState(3);break;case 1:t.st.setState(4);break;case 2:t.st.setState(5);break;case 3:(0,s.rebuildHashes)()}})}
},{"./soundObject":10,"./main":1,"./stateMachine":9,"./strings":4,"./menuItem":19,"./menu":16}],18:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class e{constructor(){this.elapsed,this.paused=!0,this.lastTime=0,this.pauseWhen=0,this.started=!0}isActive(){return!paused&started}get elapsed(){return this.paused?this.pauseWhen-this.lastTime:performance.now()-this.lastTime}pause(){this.paused=!0,this.pauseWhen=performance.now()}reset(){this.lastTime=performance.now(),this.pauseWhen=0,this.paused=!1,this.started=!0}resume(){this.paused=!1,this.started=!0,this.lastTime+=performance.now()-this.pauseWhen}}exports.OldTimer=e;
},{}],20:[function(require,module,exports) {
function n(n,e){var t,o=0,r=!1,i=0,u=0,a=e||1/120;function c(e){if(null!==o)for(i+=(e-o)/1e3;i>a;)n.update(a,u),u+=1,i-=a;o=e,n.render(),r&&(t=requestAnimationFrame(c))}function l(){o=null,r=!0,t=requestAnimationFrame(c)}function f(){r=!1,cancelAnimationFrame(t),console.log(t)}return{start:l,stop:f,change:function(n){i=a=n||1/120,u=0,f(),l()}}}module.exports=n;
},{}],14:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Game=void 0;var e=require("fs"),s=k(e),t=require("os"),i=k(t),r=require("./tts"),a=require("./main"),o=require("jquery"),l=k(o),u=require("./oldtimer"),n=require("./soundHandler"),c=require("./utilities"),h=require("./soundObject"),p=require("./stateMachine"),d=require("./timer"),y=k(d),v=require("./scrollingText"),m=require("./input.js"),f=require("./keycodes.js");function k(e){return e&&e.__esModule?e:{default:e}}class g{constructor(){this.canPause=!0,this.actionCompleted=!1,this.toDestroy=new Array,this.scoreTimer=new u.OldTimer;var e=this;(0,l.default)(document).on("blur",function(){e.pause()}),this.pauseTime=0,this.timer=null,this.music=null,this.score=0,this.pool=new n.SoundHandler,this.bpms=null,this.level=0,this.fileData=null,this.input=new m.KeyboardInput,this.input.init(),this.levels=null;e=this;this.setup()}setup(){if(s.default.existsSync(a.packdir+"bpm.txt"))this.fileData=s.default.readFileSync(a.packdir+"bpm.txt","utf8");else new v.ScrollingText("There was an error loading the pack "+this.pack+".","\n",function(){p.st.setState(2)});this.bpms=this.fileData.split(","),this.levels=this.bpms.length-1,""==this.bpms[this.levels]&&this.levels--,this.level++,h.so.directory="",s.default.existsSync(a.packdir+"nlevel.ogg")&&h.so.enqueue(a.packdir+"nlevel"),s.default.existsSync(a.packdir+"fail.ogg")&&h.so.enqueue(a.packdir+"fail");for(var e=1;e<=10;e++)s.default.existsSync(a.packdir+"a"+e+".ogg")&&(h.so.enqueue(a.packdir+"a"+e),this.actions=e),s.default.existsSync(a.packdir+"o"+e+".ogg")&&h.so.enqueue(a.packdir+"o"+e);this.keys=a.actionKeys;var t=this;this.timer=(0,y.default)({update:function(e){t.update(e)},render:function(){t.render()}},this.bpms[this.level]/1e3),h.so.setQueueCallback(function(){h.so.directory="./sounds/",t.setupLevel()}),this.queueLevels(),h.so.loadQueue()}update(e){if(0!=this.currentAction)if(!this.actionCompleted&&this.action>1)this.fail();else{if(this.currentAction++,this.currentAction>=this.numberOfActions)return h.so.directory="",h.so.destroy(a.packdir+this.level+"music"),h.so.destroy(a.packdir+"pre"+this.level),h.so.directory="./sounds/",this.level++,this.timer.stop(),void this.setupLevel();this.action=c.utils.randomInt(1,this.actions),this.actionCompleted=!1,h.so.directory="",this.pool.playStatic(a.packdir+"a"+this.action,0),h.so.directory="./sounds/",this.scoreTimer.reset()}else this.currentAction++}async fail(){this.timer.stop();var e=this.music;h.so.directory="";var s=this.pool.playStatic(a.packdir+"fail",0);h.so.directory="./sounds/";for(var t=e.playbackRate;t>0;t-=.05)e.playbackRate=t,await c.utils.sleep(30);for(e.unload();this.pool.staticSounds[s].sound.playing;)await c.utils.sleep(10),this.input.isDown(f.KeyEvent.DOM_VK_RETURN)&&this.pool.staticSounds[s].sound.unload();h.so.resetQueue(),h.so.resetQueuedInstance(),h.so.kill(function(){p.st.setState(2)})}async quit(){this.timer.stop();for(var e=this.music,s=e.playbackRate;s>0;s-=.045)e.playbackRate=s,await c.utils.sleep(30);e.unload(),h.so.resetQueue(),h.so.resetQueuedInstance(),p.st.setState(2)}render(){this.input.isJustPressed(f.KeyEvent.DOM_VK_Q)?this.quit():this.input.isJustPressed(f.KeyEvent.DOM_VK_P)?this.pause():this.handleKeys()}handleKeys(){if(!this.actionCompleted){var e=this.input.keysPressed();if(e.length>0&&1==this.action)this.fail();else{if(!(e.length>1))return 1==e.length&&e[0]==this.keys[this.action]?(h.so.directory="",this.pool.playStatic(a.packdir+"o"+this.action,0),h.so.directory="./sounds/",this.actionCompleted=!0,void this.calculateScore()):void(1!=e.length||e[0]==this.keys[this.action]||this.fail());this.fail()}}}async setupLevel(){if(this.canPause=!0,this.playing=!1,s.default.existsSync(a.packdir+"pre"+this.level+".ogg")&&(h.so.directory="",this.preSound=h.so.create(a.packdir+"pre"+this.level),h.so.directory="./sounds/",this.preSound.play(),this.playing=!0),s.default.existsSync(a.packdir+"nlevel.ogg")&&!this.playing&&this.level>1&&(h.so.directory="",this.preSound=h.so.create(a.packdir+"nlevel"),h.so.directory="./sounds/",this.preSound.play(),this.playing=!0),this.playing)for(this.queueLevels();this.preSound.playing;)await c.utils.sleep(5),this.input.isJustPressed(f.KeyEvent.DOM_VK_RETURN)&&this.preSound.stop();h.so.directory="";this.music=h.so.create(a.packdir+this.level+"music"),this.music.loop=!0,h.so.directory="./sounds/",this.music.play(),this.timer.change(this.bpms[this.level]/1e3),!this.playing&&this.level>1&&this.queueLevels(),this.action=0,this.actionCompleted=!1,this.currentAction=0,!this.playing&&this.level>1&&this.currentAction++,this.numberOfActions=c.utils.randomInt(6+this.level,2*this.level+6)}unload(){}async pause(){if(this.canPause){this.canPause=!1;var e=this.music;this.timer.stop(),this.scoreTimer.pause(),this.pauseTime=e.currentTime;for(var s=e.playbackRate;s>0;s-=.05)e.playbackRate=s,await c.utils.sleep(30);for(e.pause();!this.input.isDown(f.KeyEvent.DOM_VK_P);)await c.utils.sleep(10);this.unpause()}}async unpause(){var e=this.music;e.play();for(var s=e.playbackRate;s<=1;s+=.05)e.playbackRate=s,await c.utils.sleep(8);e.seek(this.pauseTime),this.timer.start(),this.scoreTimer.resume(),this.input.keysPressed()}calculateScore(){var e=this.bpms[this.level-1],s=c.utils.percent(this.scoreTimer.elapsed,e/2);this.scoreTimer.elapsed>e/2&&(s=100),this.scoreTimer.elapsed>e/2-20&&this.scoreTimer.elapsed<e/2+20&&(s=200);var t=e/2,i=(this.scoreTimer.elapsed-t)/e*100;this.score=Math.ceil(s-i),r.speech.speak(this.score)}queueLevels(){var e=this.level+1;this.levels<e&&(e=this.levels),h.so.directory="";for(var t=this.level;t<=e;t++)h.so.enqueue(a.packdir+t+"music"),s.default.existsSync(a.packdir+"pre"+t+".ogg")&&h.so.enqueue(a.packdir+"pre"+t);this.level>1&&(h.so.setQueueCallback(0),h.so.loadQueue(),h.so.directory="./sounds/")}}exports.Game=g;
},{"./tts":5,"./main":1,"./oldtimer":18,"./soundHandler":8,"./utilities":7,"./soundObject":10,"./stateMachine":9,"./timer":20,"./scrollingText":6,"./input.js":3,"./keycodes.js":12}],9:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.st=void 0;var e=require("./input"),t=require("./tts"),r=require("./main"),n=require("./menuHandler"),u=require("jquery"),s=d(u),a=require("./soundObject"),o=require("./keycodes"),i=require("./game");function d(e){return e&&e.__esModule?e:{default:e}}var c=new e.KeyboardInput;class l{constructor(){this.state=0,this.currentState=0}setState(t){if(1==t){(c=new e.KeyboardInput).init();var u=a.so.create("logo"),d=this;u.volume=.5,u.play(),u.sound.once("end",function(){u.unload(),(0,s.default)(document).off("keydown"),d.setState(2)}),(0,s.default)(document).keydown(function(e){e.which!=o.KeyEvent.DOM_VK_SPACE&&e.which!=o.KeyEvent.DOM_VK_ESCAPE||(u.unload(),(0,s.default)(document).off("keydown"),d.setState(2))}),this.state=t}else 2==t?(c=null,(0,n.mainMenu)(),this.state=t):3==t?(this.currentState=new i.Game,this.state=t):4==t?(0,r.learnPack)():5==t&&((0,r.browsePacks)(),this.state=t)}}var f=new l;exports.st=f;
},{"./input":3,"./tts":5,"./main":1,"./menuHandler":15,"./soundObject":10,"./keycodes":12,"./game":14}],1:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.packdir=exports.pack=exports.langs=exports.lang=exports.mangle=exports.actionKeys=void 0,exports.learnPack=P,exports.browsePacks=O,exports.rebuildHashes=q;var e=require("jquery"),t=k(e),s=require("cryptr"),a=k(s);require("hash-files");var r=require("fs-walk"),n=k(r),o=require("fs"),i=k(o),c=require("os"),l=k(c),u=require("./scrollingText"),p=require("./strings"),d=require("./soundHandler"),f=require("./tts"),y=require("./utilities"),h=require("./soundObject"),v=require("./keycodes"),g=require("./stateMachine"),m=require("./input.js");function k(e){return e&&e.__esModule?e:{default:e}}var S=exports.actionKeys=[0,0,v.KeyEvent.DOM_VK_SPACE,v.KeyEvent.DOM_VK_TAB,v.KeyEvent.DOM_VK_RETURN,v.KeyEvent.DOM_VK_BACK_SPACE,v.KeyEvent.DOM_VK_UP,v.KeyEvent.DOM_VK_DOWN,v.KeyEvent.DOM_VK_RIGHT,v.KeyEvent.DOM_VK_LEFT],b=exports.mangle=new a.default("sdf jkl wer uio"),w=exports.lang=1,x=exports.langs=["","english","spanish"],K=exports.pack="default",_=exports.packdir=l.default.homedir()+"/beatpacks/"+K+"/";function T(){g.st.setState(1)}function E(){var e=h.so.create("memtest");e.volume=.3,e.play(),h.so.destroy("memtest")}async function P(){for(var e=new d.SoundHandler,t=0,s=1;s<=10;s++)i.default.existsSync(_+"a"+s+".ogg")&&(t=s);1==w&&f.speech.speak("This pack has "+t+" actions. Typical keys are space, tab, enter, backspace, and optionally arrows up, down, left, right. If you have mapped your keyboard differently, use your custom keys instead. To hear the stop action, press the period key (to the right of comma)."),2==w&&f.speech.speak("Este pack tiene "+t+" acciones. Las teclas tpicas son espacio, tabulador, enter, bretroceso, y opcionalmente las flechas. Si has reasignado las teclas, puedes usarlas. Para escuchar la accin de parar, pulsa la tecla del punto (a la derecha de la coma).");var a=new m.KeyboardInput;for(a.init(),h.so.directory="";!a.isJustPressed(v.KeyEvent.DOM_VK_Q);)await y.utils.sleep(10),a.isJustPressed(S[2])&&e.playStatic(_+"a2",0),a.isJustPressed(S[3])&&e.playStatic(_+"a3",0),a.isJustPressed(S[4])&&e.playStatic(_+"a4",0),a.isJustPressed(S[5])&&e.playStatic(_+"a5",0),a.isJustPressed(S[6])&&e.playStatic(_+"a6",0),a.isJustPressed(S[7])&&e.playStatic(_+"a7",0),a.isJustPressed(S[8])&&e.playStatic(_+"a8",0),a.isJustPressed(S[9])&&e.playStatic(_+"a9",0),a.isJustPressed(v.KeyEvent.DOM_VK_PERIOD)&&e.playStatic(_+"a1",0);e.destroy(),h.so.directory="./sounds/",g.st.setState(2)}async function O(e=1){if(!i.default.existsSync(l.default.homedir()+"/beatpacks/hashes.db")){var t=0;return 1==w&&(t=new u.ScrollingText("The packs folder hashes need to be rebuilt to continue. This can take a few seconds...","\n",function(){q()})),void(2==w&&(t=new u.ScrollingText("Para continuar, debo reconstruir la carpeta de packs. Esto puede tardar unos segundos...","\n",function(){q()})))}try{var s=JSON.parse(b.decrypt(i.default.readFileSync(l.default.homedir()+"/beatpacks/hashes.db")))}catch(e){t=0;return 1==w&&(t=new u.ScrollingText("The packs folder hashes need to be rebuilt to continue. This can take a long while, so go get a coffee or something...","\n",function(){q()})),void(2==w&&(t=new u.ScrollingText("Para continuar, debo reconstruir la carpeta de packs. Esto puede tardar un buen rato as que ves a por un caf o algo...","\n",function(){q()})))}var a=!1;if(0==s.length)t=new u.ScrollingText(p.strings.get(w,"nopacks"),"\n",function(){a=!0});if(a)return t.destroy(),console.log("die!"),void g.st.setState(2);var r=-1,o=[],c=-1;if(e>0&&s.forEach(function(e,t){i.default.existsSync(l.default.homedir()+"/beatpacks/"+e.name+"/bpm.txt")&&o.push(e)}),h.so.directory="",o.length<1)new u.ScrollingText(p.strings.get(w,"nopacks"),"\n",g.st.setState(2));else{o.sort(function(e,t){var s=e.name.toLowerCase(),a=t.name.toLowerCase();return s<a?-1:s>a?1:0});var d,k=new m.KeyboardInput;k.init(),1==w&&f.speech.speak("ready. Browsing "+o.length+" packs. Press arrows to move, q to exit, enter to choose a pack, or page up and page down to move by larger increments."),2==w&&f.speech.speak("listo. tienes "+o.length+" packs. Pulsa flechas para moverte, q para salir, enter para elegir uno, o pulsa retroceder pgina y avanzar pgina para moverte de 20 en 20.");for(;!k.isJustPressed(v.KeyEvent.DOM_VK_Q)&&e>0;){if(k.isJustPressed(v.KeyEvent.DOM_VK_RETURN)&&(void 0!==d&&d.destroy(),-1!=r&&clearTimeout(r),-1!=c)){var S=0;if(n.default.filesSync(l.default.homedir()+"/beatpacks/"+o[c].name,function(e,t,s){S+=s.size}),S!=o[c].hash)for(e=0,f.speech.speak(p.strings.get(w,"tamperWarning")),setTimeout(function(){f.speech.speak(p.strings.get(w,"tamperWarning"))},4500);!k.isJustPressed(v.KeyEvent.DOM_VK_RETURN);)await y.utils.sleep(10);if(e>0)return exports.pack=K=o[c].name,exports.packdir=_=l.default.homedir()+"/beatpacks/"+K+"/",h.so.directory="./sounds/",void h.so.kill(function(){g.st.setState(2)})}k.isJustPressed(v.KeyEvent.DOM_VK_DOWN)&&(void 0!==d&&d.destroy(),-1!=r&&clearTimeout(r),++c>o.length-1&&(c=0),f.speech.speak(c),1==w&&f.speech.speak(o[c].name+". "+o[c].levels+" levels."),2==w&&f.speech.speak(o[c].name+". "+o[c].levels+" niveles."),r=setTimeout(function(){(d=h.so.create(o[c].preview)).play()},1e3));var x=k.getChars();if(""!=x){var T=!1;o.forEach(function(e,t){e.name.toLowerCase().slice(0,1)==x[0]&&(T||(c=t),T=!0)}),void 0!==d&&d.destroy(),-1!=r&&clearTimeout(r),1==w&&f.speech.speak(o[c].name+". "+o[c].levels+" levels."),2==w&&f.speech.speak(o[c].name+". "+o[c].levels+" niveles."),r=setTimeout(function(){(d=h.so.create(o[c].preview)).play()},1e3)}k.isJustPressed(v.KeyEvent.DOM_VK_UP)&&(void 0!==d&&d.destroy(),-1!=r&&clearTimeout(r),--c<0&&(c=o.length-1),1==w&&f.speech.speak(o[c].name+". "+o[c].levels+" levels."),2==w&&f.speech.speak(o[c].name+". "+o[c].levels+" niveles."),r=setTimeout(function(){(d=h.so.create(o[c].preview)).play()},1e3)),await y.utils.sleep(5)}-1!=r&&clearTimeout(-1),h.so.directory="./sounds/",h.so.kill(function(){g.st.setState(2)})}}function q(){var e="",t="abc",s=new Array;h.so.directory="",n.default.dirsSync(l.default.homedir()+"/beatpacks",function(a,r,o,c){if(i.default.existsSync(a+"/"+r+"/bpm.txt")){var l=0,u=a+"/"+r+"/";n.default.filesSync(u,function(e,t,s){l+=s.size}),t=l;var p=i.default.readFileSync(u+"bpm.txt","utf8").split(","),d=p.length-1;""==p[d]&&d--;var f={name:r,preview:u+"name",levels:d,hash:t};s.push(f)}else e+="\n"+r}),h.so.directory="./sounds/";var a=JSON.stringify(s);a=b.encrypt(a),i.default.writeFileSync(l.default.homedir()+"/beatpacks/hashes.db",a),""!=e?(1==w&&new u.ScrollingText("one thing before you go... the following packs are corrupt and should be looked at."+e,"\n",function(){g.st.setState(2)}),2==w&&new u.ScrollingText("Antes de que te vayas... los siguientes packs estn corruptos y deberas echar un vistazo a ver qu pasa."+e,"\n",function(){g.st.setState(2)})):g.st.setState(2)}document.addEventListener("DOMContentLoaded",T),h.so.debug=!0;
},{"./scrollingText":6,"./strings":4,"./soundHandler":8,"./tts":5,"./utilities":7,"./soundObject":10,"./keycodes":12,"./stateMachine":9,"./input.js":3}]},{},[1])